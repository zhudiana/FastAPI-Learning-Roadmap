## Alembic Revision Setup (Before Upgrade)

Before running an Alembic upgrade, we need to update some configurations in our project.

### Step 1: Update `alembic.ini`

- Inside the projectâ€™s **`alembic.ini`**, find the **DB URL**.
- Replace it with the same PostgreSQL URL you used in `database.py`.

### Step 2: Update `env.py` (inside alembic folder)

### 1. Import models

At the top of the file, add:

```python
import models
```

### 2. Remove the `if` condition

Change this:

```python
if config.config_file_name is not None:
    fileConfig(config.config_file_name)
```

To this:

```python
fileConfig(config.config_file_name)
```

### 3. Set `target_metadata`

Change this:

```python
target_metadata = None
```

To this:

```python
target_metadata = models.Base.metadata
```

Now Alembic knows about our models and database metadata, so migrations can be generated and applied correctly.

Perfect ðŸ™Œ â€” hereâ€™s your note cleaned up and formatted nicely for your roadmap in Markdown:

---

## Alembic Revision & Upgrade Example

Now letâ€™s create a new Alembic revision, apply the migration, and update our FastAPI models.

### Step 1: Create a Revision

In your project terminal, run:

```bash
alembic revision -m "Create phone number for user column"
```

- This generates a new Alembic **revision file** with a unique ID inside the `versions` folder.

### Step 2: Add Upgrade Code

Open the generated revision file and update the `upgrade` function:

```python
def upgrade() -> None:
    op.add_column('users', sa.Column('phone_number', sa.String(), nullable=True))
```

### Step 3: Run the Upgrade

In your terminal, run:

```bash
alembic upgrade your_version_id
```

- Replace `your_version_id` with the ID of the revision Alembic created.
- This applies the migration and updates the database schema.

### Step 4: Update FastAPI Models

Right now, if you run FastAPI and check the Swagger UI, `phone_number` will not appear because it isnâ€™t in the model yet.

Open **`models.py`** and update the `Users` model:

```python
phone_number = Column(String)
```

### Step 5: Verify

- Restart your FastAPI application.
- Login and fetch user information in Swagger UI.
- Now you will see the `phone_number` column included in the response.

With this, you have successfully added a new column using **Alembic migration** and updated your FastAPI models to reflect it.
