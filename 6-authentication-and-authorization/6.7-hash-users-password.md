## Hash User's Password

In the previous section, we created a user using our **auth endpoint**, but the password was saved as **plain text**. This is not safe. If the database is hacked, attackers would see the real passwords.

The correct practice is to **hash passwords** before storing them. A hash is a one-way function: you can hash a password, but you cannot get the original password back from the hash.

We’ll use **bcrypt** via the `passlib` library to handle password hashing.

### 1. Install `passlib`

```shell
pip install passlib
```

### 2. Install `bcrypt`

```shell
pip install bcrypt==4.0.1
```

### 3. Import CryptContext

In `auth.py`, add:

```python
from passlib.context import CryptContext
```

### 4. Create a bcrypt context

Under the `router`, add:

```python
# Under our router
bcrypt_context = CryptContext(schemes=['bcrypt'], deprecated="auto")
```

### 5. Hash the password

When creating the user, change the assignment of `hashed_password`:

```python
hashed_password = bcrypt_context.hash(create_user_request.password)
```

### Testing in Swagger UI

- Add a new user via the **`/auth/`** endpoint.
- Instead of seeing the plain text password in the database, you’ll now see a **long random string** (the bcrypt hash).

Example:

```json
{
  "id": 1,
  "username": "yodi",
  "email": "yodi@example.com",
  "first_name": "Yodit",
  "last_name": "K",
  "hashed_password": "$2b$12$ejSNuItZq6xD9...",
  "role": "user",
  "is_active": true
}
```
